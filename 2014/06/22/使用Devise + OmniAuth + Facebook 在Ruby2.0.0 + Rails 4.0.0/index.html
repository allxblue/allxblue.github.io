<!DOCTYPE html><html lang="zh-CN"><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><meta name="author" content="Lanc,lanc.tw"><title>使用Devise + OmniAuth + Facebook 在Ruby2.0.0 + Rails 4.0.0 · AllBlue</title><meta name="description" content="環境使用為Ruby 2.0.0 + Rails 4.0.0

請參考https://github.com/plataformatec/devise#getting-started

這邊建議不要用sqllite，所以多加個gem &amp;#39;mysql2&amp;#39;
app/config/databas"><meta name="keywords" content="Front-End,HTML,CSS,JS,Ruby on Rails, Laravel"><meta content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="renderer" content="webkit"><link rel="short icon" href="/images/favicon.png" type="image/x-icon"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/blog_basic.css"><link rel="stylesheet" href="/css/font-awesome.min.css"><link rel="alternate" type="application/atom+xml" title="ATOM 1.0" href="/atom.xml"></head><body><div class="sidebar animated fadeInDown"><div class="logo-title"><div class="title"><img src="/images/logo@2x.png" style="width:127px"><h3><a href="/">AllBlue</a></h3><div class="description"><p>Let it go.</p></div></div></div><ul class="social-links"><li><a href="https://twitter.com/lanc"><i class="fa fa-twitter"></i></a></li><li><a href="/atom.xml"><i class="fa fa-rss"></i></a></li></ul><div class="footer"><a target="_blank" href="/"><span>Theme by </span></a><a href="https://www.caicai.me">CaiCai</a><span>&</span><a href="https://github.com/Ben02/hexo-theme-Anatole"> Ben</a><div class="by_farbox"><a href="https://hexo.io/zh-cn/" target="_blank">Proudly published with Hexo&#65281;</a></div></div></div><div class="main"><div class="page-top animated fadeInDown"><div class="nav"><li><a href="/">首頁</a></li><li><a href="/about">關於</a></li><li><a href="/archives">歸檔</a></li><li><a href="/links">連結</a></li></div><div class="information"><div class="back_btn"><li><a onclick="window.history.go(-1)" class="fa fa-chevron-left"></a></li></div><div class="avatar"><img src="https://avatars1.githubusercontent.com/u/1346099?v=3&amp;s=460"></div></div></div><div class="autopagerize_page_element"><div class="content"><div class="post-page"><div class="post animated fadeInDown"><div class="post-title"><h3><a>使用Devise + OmniAuth + Facebook 在Ruby2.0.0 + Rails 4.0.0</a></h3></div><div class="post-content"><p>環境使用為Ruby 2.0.0 + Rails 4.0.0</p><blockquote><p>請參考<br><a href="https://github.com/plataformatec/devise#getting-started" target="_blank" rel="external">https://github.com/plataformatec/devise#getting-started</a></p></blockquote><p>這邊建議不要用sqllite，所以多加個<br><code>gem &#39;mysql2&#39;</code></p><p><strong>app/config/database.yml設定</strong><br></p><figure class="highlight yml"><figcaption><span>app/config/database.yml</span></figcaption><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="attr">development:</span></div><div class="line"><span class="attr">  adapter:</span> mysql2</div><div class="line"><span class="attr">  encoding:</span> utf8</div><div class="line"><span class="attr">  database:</span> database_name</div><div class="line"><span class="attr">  host:</span> localhost</div><div class="line"><span class="attr">  username:</span> root</div><div class="line"><span class="attr">  password:</span></div></pre></td></tr></table></figure><p></p><p>在 <code>Gemfile</code> 加入<br></p><figure class="highlight ruby"><figcaption><span>Gemfile</span></figcaption><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># Auth</span></div><div class="line">gem <span class="string">'devise'</span></div><div class="line">gem <span class="string">'omniauth-facebook'</span></div></pre></td></tr></table></figure><p></p><p>接著<code>bundle install</code></p><h2 id="安裝Devise"><a href="#安裝Devise" class="headerlink" title="安裝Devise"></a>安裝Devise</h2><p><code>$ rails g devise:install</code></p><h3 id="建立Devise的User-Model"><a href="#建立Devise的User-Model" class="headerlink" title="建立Devise的User Model"></a>建立Devise的User Model</h3><p><code>$ rails g devise user</code><br><code>$ rake db:migrate</code></p><h3 id="設定預設的URL選項"><a href="#設定預設的URL選項" class="headerlink" title="設定預設的URL選項"></a>設定預設的URL選項</h3><p>在<br><code>config/environments/development.rb</code><br>加入<br><code>config.action_mailer.default_url_options = { host: &#39;localhost&#39;, port: 3000 }</code></p><h3 id="產生view"><a href="#產生view" class="headerlink" title="產生view"></a>產生view</h3><p><code>$ rails g devise:views</code></p><h3 id="調整Route"><a href="#調整Route" class="headerlink" title="調整Route"></a>調整Route</h3><p>devise 會自動加入 devise_for :users<br>接著自己指定一個 root ，例如<br><code>root &quot;application#index&quot;</code></p><p>開一個view以後，<br>加入下列網址就有連結可以登入<br></p><figure class="highlight erb"><figcaption><span>app/views/applicatoin/index.html.erb</span></figcaption><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">&lt;%<span class="ruby"> <span class="keyword">if</span> user_signed_in? </span>%&gt;</div><div class="line">  &lt;p&gt;Welcome &lt;%=<span class="ruby"> current_user.email </span>%&gt;&lt;/p&gt;</div><div class="line">  &lt;%=<span class="ruby"> link_to <span class="string">'Log out'</span>, destroy_user_session_path, <span class="symbol">:method</span> =&gt; <span class="symbol">:delete</span> </span>%&gt;</div><div class="line">&lt;%<span class="ruby"> <span class="keyword">else</span> </span>%&gt;</div><div class="line">  &lt;p&gt;You are not signed in.&lt;/p&gt;</div><div class="line">  &lt;%=<span class="ruby"> link_to <span class="string">'Login'</span>, new_user_session_path </span>%&gt;</div><div class="line">&lt;%<span class="ruby"> <span class="keyword">end</span> </span>%&gt;</div></pre></td></tr></table></figure><p></p><p>複製進去就有登入介面了～</p><hr><p>※ 有在用git可以備份一下<br></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">$ git init</div><div class="line">$ git add .</div><div class="line">$ git commit -m &quot;add devise&quot;</div></pre></td></tr></table></figure><p></p><h2 id="Devise-告一段落，接下來要接-Facebook啦"><a href="#Devise-告一段落，接下來要接-Facebook啦" class="headerlink" title="Devise 告一段落，接下來要接 Facebook啦"></a>Devise 告一段落，接下來要接 Facebook啦</h2><blockquote><p>接著再參考<br><a href="https://github.com/plataformatec/devise/wiki/OmniAuth%3A-Overview" target="_blank" rel="external">https://github.com/plataformatec/devise/wiki/OmniAuth%3A-Overview</a> 及<br><a href="http://blog.xdite.net/posts/2011/12/06/omniauth-clean-auth-provider-4" target="_blank" rel="external">http://blog.xdite.net/posts/2011/12/06/omniauth-clean-auth-provider-4</a></p></blockquote><p>因為前面已經將gem放入了，就直接下一步</p><p>加入第三方的欄位到user表內產生 Authorization Model<br></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">$ rails g model Authorization provider:string user_id:integer uid:string </div><div class="line">$ rake db:migrate</div></pre></td></tr></table></figure><p></p><p>接著model設定個一對多</p><figure class="highlight ruby"><figcaption><span>app/models/authorization.rb</span></figcaption><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Authorization</span> &lt; ActiveRecord::Base</span></div><div class="line">    belongs_to <span class="symbol">:user</span> </div><div class="line"><span class="keyword">end</span></div></pre></td></tr></table></figure><figure class="highlight ruby"><figcaption><span>app/models/user.rb</span></figcaption><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">User</span> &lt; ActiveRecord::Base  </span></div><div class="line">  <span class="comment"># Include default devise modules. Others available are:</span></div><div class="line">  <span class="comment"># :confirmable, :lockable, :timeoutable and :omniauthable</span></div><div class="line">  devise <span class="symbol">:database_authenticatable</span>, <span class="symbol">:registerable</span>,</div><div class="line">         <span class="symbol">:recoverable</span>, <span class="symbol">:rememberable</span>, <span class="symbol">:trackable</span>, <span class="symbol">:validatable</span></div><div class="line"></div><div class="line">  has_many <span class="symbol">:authorizations</span></div><div class="line"><span class="keyword">end</span></div></pre></td></tr></table></figure><h2 id="設定facebook資料"><a href="#設定facebook資料" class="headerlink" title="設定facebook資料"></a>設定facebook資料</h2><p>在 <code>config/initializers/devise.rb</code>加入<br></p><figure class="highlight ruby"><figcaption><span>config/nitializers/devise.rb</span></figcaption><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">config.omniauth <span class="symbol">:facebook</span>, <span class="string">"APP_ID"</span>, <span class="string">"APP_SECRET"</span> </div><div class="line"><span class="string">`</span></div></pre></td></tr></table></figure><p></p><p>若需要不同的授權如下<br></p><figure class="highlight ruby"><figcaption><span>config/initializers/devise.rb</span></figcaption><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">config.omniauth <span class="symbol">:facebook</span>, <span class="string">"APP_ID"</span>, <span class="string">"APP_SECRET"</span>,</div><div class="line">      &#123;<span class="symbol">:scope</span> =&gt; <span class="string">'email, offline_access'</span>&#125;</div></pre></td></tr></table></figure><p></p><p><strong>加入OmniAuth到User model</strong><br>在 app/model/users.rb 的 devise後方加入 <code>:omniauthable, :omniauth_providers =&gt; [:facebook]</code> 也就是<br></p><figure class="highlight ruby"><figcaption><span>app/model/users.rb</span></figcaption><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">User</span> &lt; ActiveRecord::Base</span></div><div class="line">  <span class="comment"># Include default devise modules. Others available are:</span></div><div class="line">  <span class="comment"># :confirmable, :lockable, :timeoutable and :omniauthable</span></div><div class="line">  devise <span class="symbol">:database_authenticatable</span>, <span class="symbol">:registerable</span>,</div><div class="line">         <span class="symbol">:recoverable</span>, <span class="symbol">:rememberable</span>, <span class="symbol">:trackable</span>, <span class="symbol">:validatable</span>,</div><div class="line">         <span class="symbol">:omniauthable</span>, <span class="symbol">:omniauth_providers</span> =&gt; [<span class="symbol">:facebook</span>]</div><div class="line"></div><div class="line">  has_many <span class="symbol">:authorizations</span></div><div class="line">  </div><div class="line"><span class="keyword">end</span></div></pre></td></tr></table></figure><p></p><h3 id="調整Route-1"><a href="#調整Route-1" class="headerlink" title="調整Route"></a>調整Route</h3><p>將Route內的 devise_for: 加入 controller，也就是<br></p><figure class="highlight ruby"><figcaption><span>routes.rb</span></figcaption><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">devise_for <span class="symbol">:users</span>, <span class="symbol">:controllers</span> =&gt; &#123; <span class="symbol">:omniauth_callbacks</span> =&gt; <span class="string">"users/omniauth_callbacks"</span> &#125;</div></pre></td></tr></table></figure><p></p><p>意思為只要收到的是 <strong>moniauth_callbacks型態 </strong>就指向 <strong>users controller的omniauth_callbacks method</strong><br>可自行設定為<br></p><figure class="highlight ruby"><figcaption><span>routes.rb</span></figcaption><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div></pre></td><td class="code"><pre><div class="line">devise_for <span class="symbol">:users</span>, <span class="symbol">:controllers</span> =&gt; &#123; </div><div class="line">    <span class="symbol">:registrations</span> =&gt; <span class="string">"registrations"</span>, <span class="comment">#註冊頁</span></div><div class="line">    <span class="symbol">:omniauth_callbacks</span> =&gt; <span class="string">"users/omniauth_callbacks"</span> <span class="comment">#接收redirect的controller</span></div><div class="line">  &#125; <span class="keyword">do</span></div><div class="line">    get <span class="string">"logout"</span> =&gt; <span class="string">"devise/sessions#destroy"</span></div><div class="line"><span class="keyword">end</span></div><div class="line"><span class="string">``</span><span class="string">`  </span></div><div class="line"></div><div class="line">__redirect處理__</div><div class="line"></div><div class="line">建立 `app/controllers/users/omniauth_callbacks_controller.rb<span class="string">` </span></div><div class="line">這裡主要是 ** 接收redirect資訊取user資訊 **或是建立新使用者，並** 將其寫入session **來判斷會員狀態 </div><div class="line"></div><div class="line">`<span class="string">``</span> ruby app/controllers/users/omniauth_callbacks_controller.rb</div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Users::OmniauthCallbacksController</span> &lt; Devise::OmniauthCallbacksController</span></div><div class="line"> <span class="function"><span class="keyword">def</span> <span class="title">facebook</span></span></div><div class="line">    <span class="comment"># You need to implement the method below in your model (e.g. app/models/user.rb)</span></div><div class="line">    @user = User.find_for_facebook_oauth(request.env[<span class="string">"omniauth.auth"</span>])</div><div class="line"></div><div class="line">    <span class="keyword">if</span> @user.persisted?</div><div class="line">      sign_in_and_redirect @user, <span class="symbol">:event</span> =&gt; <span class="symbol">:authentication</span> <span class="comment">#this will throw if <span class="doctag">@user</span> is not activated</span></div><div class="line">      set_flash_message(<span class="symbol">:notice</span>, <span class="symbol">:success</span>, <span class="symbol">:kind</span> =&gt; <span class="string">"Facebook"</span>) <span class="keyword">if</span> is_navigational_format?</div><div class="line">    <span class="keyword">else</span></div><div class="line">      session[<span class="string">"devise.facebook_data"</span>] = request.env[<span class="string">"omniauth.auth"</span>]</div><div class="line">      redirect_to new_user_registration_url</div><div class="line">    <span class="keyword">end</span></div><div class="line">  <span class="keyword">end</span></div><div class="line"></div><div class="line"><span class="keyword">end</span></div></pre></td></tr></table></figure><p></p><p>接收到的格式可參考</p><blockquote><p><a href="https://github.com/intridea/omniauth/wiki/Auth-Hash-Schema" target="_blank" rel="external">https://github.com/intridea/omniauth/wiki/Auth-Hash-Schema</a></p></blockquote><p>大概長這樣<br></p><figure class="highlight"><figcaption><span>Auth hash schema</span></figcaption><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div></pre></td><td class="code"><pre><div class="line">&#123;"provider"=&gt;"facebook",</div><div class="line"> "uid"=&gt;"1490623964507376",</div><div class="line"> "info"=&gt;</div><div class="line">  &#123;"email"=&gt;"open_bkunfsm_user@tfbnw.net",</div><div class="line">   "name"=&gt;"Open Graph Test User",</div><div class="line">   "first_name"=&gt;"Open",</div><div class="line">   "last_name"=&gt;"User",</div><div class="line">   "image"=&gt;"http://graph.facebook.com/1490623964507376/picture",</div><div class="line">   "urls"=&gt;</div><div class="line">    &#123;"Facebook"=&gt;</div><div class="line">      "https://www.facebook.com/app_scoped_user_id/1490623964507376/"&#125;,</div><div class="line">   "verified"=&gt;false&#125;,</div><div class="line"> "credentials"=&gt;</div><div class="line">  &#123;"token"=&gt;</div><div class="line">    "CAAHS4NieH9ABALBHSUAecP4MDHkgul2gn1gSnBsZBVjceF1GZB2x9Uv8VaYZBcxuwGlj</div><div class="line">   "expires_at"=&gt;1408167744,</div><div class="line">   "expires"=&gt;true&#125;,</div><div class="line"> "extra"=&gt;</div><div class="line">  &#123;"raw_info"=&gt;</div><div class="line">    &#123;"id"=&gt;"1490623964507376",</div><div class="line">     "email"=&gt;"open_bkunfsm_user@tfbnw.net",</div><div class="line">     "first_name"=&gt;"Open",</div><div class="line">     "gender"=&gt;"female",</div><div class="line">     "last_name"=&gt;"User",</div><div class="line">     "link"=&gt;"https://www.facebook.com/app_scoped_user_id/1490623964507376</div><div class="line">     "locale"=&gt;"en_US",</div><div class="line">     "middle_name"=&gt;"Graph Test",</div><div class="line">     "name"=&gt;"Open Graph Test User",</div><div class="line">     "timezone"=&gt;8,</div><div class="line">     "updated_time"=&gt;"2014-06-15T06:29:28+0000",</div><div class="line">     "verified"=&gt;false&#125;&#125;&#125;</div></pre></td></tr></table></figure><p></p><p>接著建立model去處理接收的provider資訊<br>在 <code>app/models/user.rb</code> 底下新增 <strong>find_for_facebook_oauth</strong> method，這個方法 <strong>omniauth_callbacks_controller </strong>會呼叫。</p><figure class="highlight ruby"><figcaption><span>app/models/user.rb</span></figcaption><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">self</span>.<span class="title">find_for_facebook_oauth</span><span class="params">(auth)</span></span></div><div class="line">      <span class="comment"># binding.pry      </span></div><div class="line">      </div><div class="line">      authentication = Authorization.where(auth.slice(<span class="symbol">:provider</span>, <span class="symbol">:uid</span>)).first</div><div class="line">   <span class="keyword">if</span> authentication</div><div class="line">      user = authentication.user</div><div class="line">  <span class="keyword">else</span></div><div class="line">     user = User.new;</div><div class="line">     user.email = auth.info.email</div><div class="line">     user.password = Devise.friendly_token[<span class="number">0</span>,<span class="number">20</span>]</div><div class="line">     <span class="keyword">if</span> user.save(<span class="symbol">:validate</span> =&gt; <span class="literal">false</span>)</div><div class="line">        user.authorizations &lt;&lt; Authorization.new(<span class="symbol">:provider</span> =&gt; auth.provider, <span class="symbol">:uid</span> =&gt; auth.uid )</div><div class="line">        user.save</div><div class="line">        user</div><div class="line">    <span class="keyword">else</span></div><div class="line">          Rails.logger.warn(<span class="string">"User create fail, <span class="subst">#&#123;user.errors.inspect&#125;</span>"</span>)</div><div class="line">    <span class="keyword">end</span></div><div class="line">   <span class="keyword">end</span></div><div class="line"><span class="keyword">end</span></div></pre></td></tr></table></figure><p>補上登出<br></p><figure class="highlight ruby"><figcaption><span>app/models/user.rb</span></figcaption><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">self</span>.<span class="title">new_with_session</span><span class="params">(params, session)</span></span></div><div class="line">   <span class="keyword">super</span>.tap <span class="keyword">do</span> <span class="params">|user|</span></div><div class="line">     <span class="keyword">if</span> data = session[<span class="string">"devise.facebook_data"</span>] &amp;&amp; session[<span class="string">"devise.facebook_data"</span>][<span class="string">"extra"</span>][<span class="string">"raw_info"</span>]</div><div class="line">       user.email = data[<span class="string">"email"</span>] <span class="keyword">if</span> user.email.blank?</div><div class="line">     <span class="keyword">end</span></div><div class="line">   <span class="keyword">end</span></div><div class="line"> <span class="keyword">end</span></div></pre></td></tr></table></figure><p></p><p>OK，搞定，可以測試啦</p></div><div class="post-footer"><div class="meta"><div class="info"><i class="fa fa-sun-o"></i><span class="date">2014-06-22</span><i class="fa fa-tag"></i><a href="/categories/Ruby-on-Rails/" title="Ruby on Rails" class="tag">Ruby on Rails </a><a href="/tags/Ruby-on-Rails/" title="Ruby on Rails" class="tag">Ruby on Rails </a><a href="/tags/Devise/" title="Devise" class="tag">Devise </a><a href="/tags/OmniAuth/" title="OmniAuth" class="tag">OmniAuth </a><a href="/tags/Facebook/" title="Facebook" class="tag">Facebook</a></div></div></div></div><div class="share"><div class="evernote"><a href="javascript:(function(){EN_CLIP_HOST='http://www.evernote.com';try{var%20x=document.createElement('SCRIPT');x.type='text/javascript';x.src=EN_CLIP_HOST+'/public/bookmarkClipper.js?'+(new%20Date().getTime()/100000);document.getElementsByTagName('head')[0].appendChild(x);}catch(e){location.href=EN_CLIP_HOST+'/clip.action?url='+encodeURIComponent(location.href)+'&amp;title='+encodeURIComponent(document.title);}})();" ref="nofollow" target="_blank" class="fa fa-bookmark"></a></div><div class="weibo"><a href="javascript:void((function(s,d,e){try{}catch(e){}var f='http://service.weibo.com/share/share.php?',u=d.location.href,p=['url=',e(u),'&amp;title=',e(d.title),'&amp;appkey=2924220432'].join('');function a(){if(!window.open([f,p].join(''),'mb',['toolbar=0,status=0,resizable=1,width=620,height=450,left=',(s.width-620)/2,',top=',(s.height-450)/2].join('')))u.href=[f,p].join('');};if(/Firefox/.test(navigator.userAgent)){setTimeout(a,0)}else{a()}})(screen,document,encodeURIComponent));" class="fa fa-weibo"></a></div><div class="twitter"><a href="http://twitter.com/home?status=,http://allxblue.github.io/2014/06/22/使用Devise + OmniAuth + Facebook 在Ruby2.0.0 + Rails 4.0.0/,AllBlue,使用Devise + OmniAuth + Facebook 在Ruby2.0.0 + Rails 4.0.0,;" class="fa fa-twitter"></a></div><div class="facebook"><a href="https://facebook.com/sharer.php?u=,http://allxblue.github.io/2014/06/22/使用Devise + OmniAuth + Facebook 在Ruby2.0.0 + Rails 4.0.0/,AllBlue,使用Devise + OmniAuth + Facebook 在Ruby2.0.0 + Rails 4.0.0,;" class="fa fa-facebook"></a></div><div class="google-plus"><a href="https://plus.google.com/share?url=,http://allxblue.github.io/2014/06/22/使用Devise + OmniAuth + Facebook 在Ruby2.0.0 + Rails 4.0.0/,AllBlue,使用Devise + OmniAuth + Facebook 在Ruby2.0.0 + Rails 4.0.0,;" class="fa fa-google-plus"></a></div></div><div class="pagination"><ul class="clearfix"><li class="pre pagbuttons"><a role="navigation" href="/2014/07/02/常用的 gulp 及設定/" title="常用的 gulp plugin 整理" class="btn">上一篇</a></li><li class="next pagbuttons"><a role="navigation" href="/2014/06/16/在windows上使用vagrant架設Ruby on Rails 開發環境/" title="在windows上使用vagrant架設Ruby on Rails 開發環境" class="btn">下一篇</a></li></ul></div></div></div></div></div><script src="/js/jquery.js"></script><script src="/js/jquery-migrate-1.2.1.min.js"></script><script src="/js/jquery.appear.js"></script></body></html>